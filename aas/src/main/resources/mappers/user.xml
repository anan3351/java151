<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user">

    <insert id="insert" parameterType="com.example.demo.user.UserDTO">
    INSERT INTO aas.tb_user (user_id, pwd, user_name, tel_num, post, addr1, addr2, email, snum)
    VALUES (#{user_id}, #{pwd}, #{user_name}, #{tel_num}, #{post}, #{addr1}, #{addr2}, #{email}, #{snum})
	</insert>
	
	 <select id="isUserIdDuplicate" parameterType="string" resultType="int">
	SELECT COUNT(*) FROM aas.tb_user WHERE user_id = #{user_id}
	</select>
	
	<select id="isEmailDuplicate" parameterType="string" resultType="int">
    SELECT COUNT(*) FROM aas.tb_user WHERE email = #{email}
	</select>
	
	<select id="login" parameterType="string" resultType="com.example.demo.user.UserDTO">
    SELECT * FROM aas.tb_user WHERE user_id = #{user_id}
	</select>
	
    <select id="getUserById" parameterType="string" resultType="com.example.demo.user.UserDTO">
    SELECT user_id, user_name, auth, level_name, u_point FROM aas.tb_user WHERE user_id = #{user_id}
	</select>
	
	<update id="updateUserInfo" parameterType="com.example.demo.user.UserDTO">
    UPDATE aas.tb_user
    <set>
        <if test="name != null and name != ''">
            name = #{name},
        </if>
        <if test="email != null and email != ''">
            email = #{email},
        </if>
        <if test="tel_num != null and tel_num != ''">
            tel_num = #{tel_num},
        </if>
    </set>
    WHERE user_id = #{user_id}
	</update>
	
	<select id="getUserInfo" parameterType="string" resultType="com.example.demo.user.UserDTO">
        SELECT user_id, user_name, email, tel_num
        FROM aas.tb_user
        WHERE user_id = #{user_id}
    </select>
    
    <update id="updatePassword" parameterType="map">
    UPDATE aas.tb_user SET pwd = #{pwd} WHERE user_id = #{userId}
	</update>
	
	<delete id="deleteUser" parameterType="string">
    DELETE FROM aas.tb_user WHERE user_id = #{user_id}
	</delete>
	
	<select id="findByUserId" parameterType="string" resultType="com.example.demo.user.UserDTO">
    SELECT * FROM aas.tb_user WHERE user_id = #{userId}
	</select>
	
	<insert id="insertNaverUser" parameterType="com.example.demo.user.UserDTO">
	    INSERT INTO aas.tb_user (user_id, user_name, tel_num, email, pwd)
	    VALUES (#{user_id}, #{user_name}, #{tel_num}, #{email}, 'NAVER_LOGIN')
	</insert>
	
	<update id="updateNaverUser" parameterType="com.example.demo.user.UserDTO">
	    UPDATE aas.tb_user
	    SET user_name = #{user_name}, tel_num = #{tel_num}, email = #{email}
	    WHERE user_id = #{user_id}
	</update>
	
	<select id="countByUserId" parameterType="string" resultType="int">
    SELECT COUNT(*) FROM aas.tb_user WHERE user_id = #{userId}
	</select>
	
	<select id="findByNaverId" parameterType="string" resultType="com.example.demo.user.UserDTO">
	    SELECT * FROM aas.tb_user WHERE user_id = #{naverId}
	</select>
	
	<insert id="insertKakaoUser" parameterType="com.example.demo.user.UserDTO">
        INSERT INTO aas.tb_user (user_id, auth)
        VALUES (#{user_id}, #{auth})
    </insert>
    
    <select id="getUserByUserId" parameterType="string" resultType="com.example.demo.user.UserDTO">
        SELECT * FROM aas.tb_user WHERE user_id = #{user_id}
    </select>
	


    
</mapper>